# V3.0 Research Roadmap: Real-Time & Predictive Analysis

**Author**: CLI 4 (The Lab)
**Date**: 2025-10-06
**Target Timeline**: 2026-Q1 Research, 2026-Q2 Prototype
**Status**: 🔬 Research Phase (Pre-Implementation)

---

## 🎯 V3.0 Vision Statement

**Transform the LOL bot from a post-game analysis tool into a real-time coaching assistant that provides predictive insights during champion select and immediate feedback after match completion.**

### Core Value Propositions

1. **Real-Time Delivery**: Reduce analysis latency from minutes to seconds
2. **Predictive Insights**: Forecast match outcomes, objective steal probability, player tilt
3. **Pre-Game Coaching**: Champion/role recommendations during champion select
4. **Voice Feedback**: Hands-free coaching for casual players

---

## 📊 User Demand Analysis

### Feedback Source: V2.1 Post-Analysis Surveys

| Feature Request | % Users | Urgency | Technical Feasibility | Compliance Risk |
|-----------------|---------|---------|----------------------|-----------------|
| **Faster feedback (real-time)** | 42% | High | Medium | **🔴 HIGH** |
| **Outcome prediction (win %)**  | 28% | Medium | High | 🟡 Medium |
| **Voice playback (TTS)** | 18% | Low | Low | 🟢 Low |
| **Team-wide analysis** | 12% | Low | Medium | 🟢 Low |

**Key Insight**: 42% of users want real-time analysis, but this carries the highest compliance risk. V3.0 must prioritize Riot policy compliance research.

---

## 🚀 V3.0 Feature Roadmap

### Phase 1: Real-Time Analysis Infrastructure (V3.1)

**Goal**: Reduce analysis latency from 2-3 minutes to <30 seconds

#### Technical Approach

**Current Bottleneck Analysis**:
```
Current V2.1 flow:
1. Match ends                             → 0s
2. Wait for Riot API match data           → 60-120s (Match-V5 indexing delay)
3. Fetch Match-V5 + Timeline              → 5-10s
4. V2.1 evidence extraction               → 8-12s
5. LLM generation                         → 3-5s
6. Total: 76-147 seconds
```

**V3.1 Optimizations**:

1. **Live Client Data API Integration**:
   - Access in-game data without waiting for Match-V5 indexing
   - Available immediately after match ends
   - **Compliance concern**: Must verify allowed data types (see V3_REALTIME_COMPLIANCE_RISK_ASSESSMENT.md)

2. **Incremental Analysis**:
   - Pre-compute V1 scores during match (if using Live Client Data)
   - Generate partial analysis at match end, finalize with Timeline data later
   - **Trade-off**: Partial analysis may have lower actionability

3. **Caching & Pre-fetching**:
   - Cache user profiles (already in V2.2)
   - Pre-fetch champion stats during match
   - **Impact**: -2-3s latency

**Projected Latency**:
```
V3.1 flow (optimized):
1. Match ends                             → 0s
2. Live Client Data API pull              → 2-3s (no indexing wait)
3. V1 scoring (pre-computed)              → 0s (done during match)
4. V2.1 evidence extraction (partial)     → 5-8s (no Timeline yet)
5. LLM generation                         → 3-5s
6. Total: 10-16 seconds ✅ (<30s target)

Timeline data enrichment (background):
7. Wait for Match-V5 Timeline             → +60-120s
8. Enrich suggestions with Timeline       → +5-8s
9. Update analysis (optional refinement)  → +3-5s
```

**Decision Point**: Should V3.1 deliver a "quick analysis" in 10-16s, then refine with Timeline data later?
- **Pro**: Meets user demand for speed
- **Con**: May confuse users with "analysis updates"

**Recommendation**: A/B test "quick analysis" vs "wait for complete data"

---

### Phase 2: Predictive Analytics (V3.2)

**Goal**: Forecast match outcomes and objective steal probability using ML models

#### Feature 2.1: Win Probability Prediction (Champion Select)

**Use Case**: During champion select, show user their team composition's win probability vs enemy team

**Example UI**:
```
📊 Team Composition Analysis
Your Team Win Probability: 52.3%
Enemy Team Win Probability: 47.7%

Key Matchup Concerns:
  ⚠️  敌方中单 Yasuo counters 你的ADC Jinx (63% win rate)
  ✅ 你的打野 Lee Sin counters 敌方打野 Evelynn (58% win rate)
```

**Technical Approach**:

1. **Data Collection**:
   - Fetch historical match data for all 10 champions
   - Champion synergy matrix (e.g., Yasuo + Malphite = high synergy)
   - Counter-pick win rates (e.g., Yasuo vs Jinx = 63% Yasuo win rate)

2. **ML Model**:
   ```python
   # Feature engineering
   features = {
       "team_avg_win_rate": 0.51,
       "enemy_avg_win_rate": 0.49,
       "synergy_score_team": 0.72,  # Yasuo + Malphite combo
       "synergy_score_enemy": 0.58,
       "counter_pick_advantage": -0.05,  # Net counter-pick score
       "role_balance_team": 1.0,  # Has all 5 roles
       "role_balance_enemy": 0.8,  # Missing primary jungler
   }

   # Model prediction
   win_prob = gradient_boosting_model.predict(features)
   # Output: 0.523 (52.3% win probability)
   ```

3. **Model Training**:
   - Dataset: Last 100,000 ranked matches (Match-V5)
   - Target: Match outcome (win/loss)
   - Validation: 80/20 train/test split, AUC-ROC >0.65

**Compliance Check**:
- ✅ **Allowed**: Pre-game champion analysis (no real-time advantage)
- ✅ **Allowed**: Historical win rates (publicly available data)
- ❌ **Prohibited**: Real-time tracking of enemy skill usage

**Projected Accuracy**: 60-65% (better than random, but not guaranteed)

**User Value**: Helps players make informed champion choices, reduces tilt ("这局开局就不好，别太在意")

---

#### Feature 2.2: Objective Steal Probability (Real-Time)

**Use Case**: At 20:00 game time, show probability of enemy stealing Baron if team attempts it without vision

**Example UI**:
```
⚠️  大龙偷取风险评估
如果现在开龙（无视野）：
  敌方偷龙概率: 68% 🔴 HIGH RISK

建议：
  1. 先放置2个真眼在大龙坑上方和河道
  2. 等待敌方打野位置暴露
  3. 降低偷龙概率至 <30%
```

**Technical Approach**:

1. **Feature Extraction (from Live Client Data)**:
   ```python
   features = {
       "team_vision_in_baron_area": False,  # No wards
       "enemy_jungler_smite_available": True,  # Likely (no recent smite usage)
       "baron_hp_remaining": 0.4,  # 40% HP
       "team_burst_damage": 8500,  # Total team burst
       "enemy_jungler_burst_damage": 1200,  # Enemy jungler burst
       "distance_enemy_jungler_to_baron": 2500,  # Units
   }
   ```

2. **ML Model**:
   - Binary classification: Stolen (1) vs Secured (0)
   - Training data: Matches where Baron attempts occurred
   - Features: Vision control, burst damage, jungler position

**Compliance Concern**: 🔴 **HIGH RISK**
- This feature provides **real-time competitive advantage** (enemy jungler position tracking)
- **Likely prohibited** under Riot ToS (unfair information advantage)

**Recommendation**: **DO NOT implement** until compliance is vetted (see V3_REALTIME_COMPLIANCE_RISK_ASSESSMENT.md)

---

### Phase 3: Voice Feedback (V3.3 / V2.3 Quick Win)

**Goal**: Enable hands-free coaching for casual players

#### Feature 3.1: TTS (Text-to-Speech) Analysis Playback

**Use Case**: User receives audio version of V2.2 analysis, playable in Discord voice channel

**Example**:
```
🔊 语音播报已生成（时长：2分15秒）
点击播放：[▶️ 播放分析]

"你好，这是你最近一场比赛的分析报告。你使用的是 Jinx，
这场比赛你的整体表现不错，综合评分77.8分。但是在视野控制方面，
你的得分只有62.4分，在队伍中排名第4。我注意到在24分16秒的时候..."
```

**Technical Implementation**:

1. **TTS Service Integration**:
   - **Option A**: Google Cloud TTS (multi-language support, high quality)
   - **Option B**: Azure Speech Services (更好的中文支持)
   - **Option C**: Volcengine TTS (国内延迟更低)

2. **Script Generation**:
   ```python
   # Convert V2.2 report to TTS-friendly script
   def generate_tts_script(report: V21PrescriptiveAnalysisReport) -> str:
       script = f"你好，这是你最近一场比赛的分析报告。"
       script += f"你使用的是 {report.champion_name}，"
       script += f"这场比赛你的整体表现{'不错' if report.overall_score > 70 else '有待提升'}。"

       for suggestion in report.improvement_suggestions[:3]:  # Top 3 only
           script += f"在 {suggestion.dimension} 维度，"
           script += simplify_for_speech(suggestion.action_item)

       return script
   ```

3. **Discord Audio Playback**:
   - Generate audio file (MP3/OGG)
   - Upload to Discord CDN or S3
   - Embed audio player in Discord message

**Cost Analysis**:
- Google Cloud TTS: $4 per 1M characters
- Average script length: 800 characters
- Cost per analysis: $0.0032 (negligible)

**Compliance Check**:
- ✅ **Allowed**: Audio playback of post-game analysis (no competitive advantage)

**User Value**: 18% of users (mainly casual players) prefer audio over reading

**Priority**: 🟢 **Quick Win** - Can implement in V2.3 before V3.0

---

### Phase 4: Team-Wide Analysis (V3.4)

**Goal**: Analyze all 5 teammates' performance and identify team-level weaknesses

**Use Case**: Show captain/shotcaller a team-wide report highlighting coordination gaps

**Example UI**:
```
👥 团队整体分析（5人）

整体评分: 68.2/100
团队弱点: Vision Control（平均62.1分）

个人表现排名:
  1. 中单 Player1（79.3分）⭐ MVP
  2. 打野 Player2（75.8分）
  3. ADC 你（77.8分）
  4. 辅助 Player4（66.2分）
  5. 上单 Player5（59.4分）⚠️ 需要改进

团队协作建议:
  ⚠️  你的辅助（Player4）和上单（Player5）的视野得分偏低，
      建议打野（Player2）在前期帮助上半区建立视野优势。
```

**Technical Implementation**:

1. **Multi-Player Data Aggregation**:
   - Require all 5 players to opt-in (privacy consideration)
   - Aggregate V2.1 reports for all 5 players
   - Identify team-level patterns (e.g., "整个团队视野控制薄弱")

2. **Team Coordination Analysis**:
   ```python
   # Detect coordination gaps
   if (
       support_vision_score < 60
       and jungle_vision_score < 60
       and adc_vision_score < 60
   ):
       team_weakness = "整个团队缺乏视野意识，需要在赛前沟通视野分工"
   ```

**Compliance Check**:
- ✅ **Allowed**: Team-wide post-game analysis (no competitive advantage)
- ⚠️  **Privacy**: Requires all players' consent to share data

**User Value**: 12% of users (mainly premade teams) requested this feature

**Priority**: 🟢 **V3.4** - Lower priority, but low compliance risk

---

## 🗺️ V3.0 Implementation Timeline

### 2025-Q4: Compliance Research & Feasibility Study

| Task | Duration | Deliverable | Owner |
|------|----------|-------------|-------|
| Riot Live Client Data API policy review | 2 weeks | Compliance assessment report | CLI 4 |
| Live Client Data API integration prototype | 3 weeks | Python adapter + data extraction | CLI 2 |
| Real-time latency testing | 1 week | Performance benchmark report | CLI 3 |
| Win probability ML model training | 4 weeks | Trained model + validation report | CLI 4 |

**Decision Point**: If compliance issues found, pivot to V3.3 (TTS) instead of V3.1 (real-time)

---

### 2026-Q1: V3.1 Real-Time Analysis (Conditional)

**Prerequisites**:
- ✅ Compliance clearance from Riot API team
- ✅ Live Client Data API adapter tested

| Task | Duration | Deliverable |
|------|----------|-------------|
| Live Client Data integration | 3 weeks | Real-time data pipeline |
| Incremental analysis logic | 2 weeks | Quick analysis (10-16s latency) |
| A/B test: Quick vs Complete analysis | 2 weeks | User preference data |
| Production rollout (if successful) | 1 week | V3.1 release |

**Total**: 8 weeks

---

### 2026-Q2: V3.2 Predictive Analytics

| Task | Duration | Deliverable |
|------|----------|-------------|
| Win probability model deployment | 2 weeks | Champion select prediction API |
| Frontend integration (champion select UI) | 2 weeks | Discord embed with win % |
| User testing & feedback | 2 weeks | Validation of model accuracy |
| Production rollout | 1 week | V3.2 release |

**Total**: 7 weeks

---

### 2026-Q3: V3.3 Voice Feedback (Quick Win - Can Move to V2.3)

| Task | Duration | Deliverable |
|------|----------|-------------|
| TTS service integration | 1 week | Audio generation API |
| Script generation logic | 1 week | TTS-friendly text conversion |
| Discord audio playback | 1 week | Audio embed in messages |
| User testing | 1 week | Feedback collection |
| Production rollout | 1 week | V3.3 release |

**Total**: 5 weeks

**Note**: This can be fast-tracked to V2.3 (before V3.0) due to low complexity and high user value

---

## 📊 Success Criteria for V3.0

| Metric | V2.2 Baseline | V3.0 Target | Measurement Method |
|--------|---------------|-------------|---------------------|
| **Analysis Latency (P95)** | 76-147s | **<30s** | Server logs |
| **User Satisfaction** | 80-85% | **85-90%** | Feedback surveys |
| **Win Probability Accuracy** | N/A | **60-65% AUC-ROC** | ML model validation |
| **TTS Adoption Rate** | N/A | **20-25%** | TTS playback clicks / total analyses |
| **Cost per Analysis** | $0.014 | **<$0.020** | LLM + TTS cost tracking |

---

## ⚠️ Risk Assessment

### High-Risk Items

1. **Riot API Compliance** (V3.1 Real-Time Analysis)
   - **Risk**: Violation of ToS → API key revocation
   - **Mitigation**: Thorough compliance review before implementation (see V3_REALTIME_COMPLIANCE_RISK_ASSESSMENT.md)
   - **Contingency**: If real-time is prohibited, focus on V3.2 (predictive) and V3.3 (TTS)

2. **Model Accuracy** (V3.2 Predictive Analytics)
   - **Risk**: <55% accuracy → users lose trust in predictions
   - **Mitigation**: Set clear expectations ("预测准确率约60%，仅供参考")
   - **Contingency**: If accuracy too low, pivot to simpler heuristics (e.g., champion counter-pick tables)

### Medium-Risk Items

1. **Latency Targets** (V3.1)
   - **Risk**: Live Client Data API slower than expected
   - **Mitigation**: Implement fallback to Match-V5 if latency >30s
   - **Contingency**: Deliver "quick analysis" in 15-20s, enrich later

2. **User Privacy** (V3.4 Team-Wide Analysis)
   - **Risk**: Users uncomfortable sharing data with teammates
   - **Mitigation**: Require explicit opt-in, allow data hiding

---

## 🎓 Lessons from V2.2 Applied to V3.0

1. **Start with Compliance**: V2.1 success due to upfront Riot policy compliance
   - **V3.0**: Compliance research is Phase 0, not afterthought

2. **Structured Output Reduces Failure**: V2.1 JSON Mode reduced hallucination
   - **V3.0**: Use structured ML model outputs (probabilities, not narratives)

3. **User Feedback Drives Iteration**: V2.1 actionability analysis identified Combat/Teamplay gaps
   - **V3.0**: Implement detailed telemetry for win probability prediction accuracy

4. **Quick Wins Buy Time for Big Bets**: V2.2 personalization was low-hanging fruit
   - **V3.0**: TTS (V3.3) is quick win while V3.1 real-time undergoes compliance review

---

## 🔮 Looking Beyond V3.0: V4.0 Opportunities

### Emerging Technologies

1. **Multimodal AI (Vision + Language)**:
   - Analyze match VOD footage, not just stats
   - Example: "在24:16团战中，你站位过于靠前（红圈标注），导致被敌方集火"

2. **Reinforcement Learning Coaching**:
   - Train RL agent on professional matches
   - Provide "what would Faker do?" suggestions

3. **Cross-Platform Integration**:
   - Integrate with op.gg, u.gg for broader user reach
   - In-game overlay (requires Overwolf or similar)

**Timeline**: 2027+ (post-V3.0 stabilization)

---

## 📄 Conclusion

V3.0 represents a paradigm shift from **post-game analysis** to **real-time coaching assistant**.

**Core Focus**:
1. **Real-time delivery** (<30s latency) via Live Client Data API
2. **Predictive insights** (win probability, objective risks) via ML models
3. **Voice feedback** (TTS) for casual players

**Highest Priority**: **Compliance research for real-time features** (V3.1)
**Quick Win**: **TTS voice feedback** (V3.3, can be V2.3)

**Status**: ✅ **Roadmap defined, compliance research ready to begin**

---

**Next Steps**:
1. CLI 4 to complete **V3_REALTIME_COMPLIANCE_RISK_ASSESSMENT.md** (detailed Riot policy analysis)
2. CLI 2 to prototype Live Client Data API integration (2-week feasibility study)
3. CLI 4 to begin win probability ML model training (parallel to compliance research)

**Expected Decision Point**: 2025-12-01 (Go/No-Go for V3.1 real-time features)

---

**Document Version**: 1.0
**Last Updated**: 2025-10-06
**Next Review**: After compliance research completion (2025-12-01)
